
<!DOCTYPE html>
<html>
 <head>
    <title>Friday Facts #60 - Tests all around | Factorio</title>
    <link href="/static/img/favicon.ico" rel="icon" type="image/x-icon"/>
    <link href="/static/img/favicon.ico" rel="shortcut icon" type="image/x-icon"/>
    <link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
    <link href="/static/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css"/>
    <link href="/static/css/factorio.css" rel="stylesheet" type="text/css"/>
    <link href="/static/lightbox/css/lightbox.css" rel="stylesheet" type="text/css"/>
    <link href="/blog/rss" rel="alternate" title="Recent Blog Posts" type="application/atom+xml">
    <meta name="viewport" content="width=device-width">
    
    
 </head>
 <body style="background: rgb(22, 22, 22) url(/static/img/stressed_linen_texture.png) repeat 0 0;'">
  <div class="container header" style="margin-top: 30px;">

    <!-- top row -->
   <div class="row" style="margin-bottom: 30px;">
     <div class="span4">
       <a href="/"><img src="/static/img/factorio-logo.png" style="margin-top: 10px;"/></a>
     </div>
    <div class="span8 span8-navbar" style="margin-top: 10px;">
     <div class="user-controls">
      
           <a href="/login">log in</a>
           <a href="/signup">sign up</a>
      
     </div>

     

      

     <div class="navbar">
      <ul class="nav">
        
          
            <li >

            
              <a href=/
                 
              > Home </a>
            

            </li>
        
          
            <li >

            
              <a href=/store
                  style="color: #ff7200;" 
              > Merch </a>
            

            </li>
        
          
            <li  class="custom-dropdown" >

            

              <a class="custom-dropdown-toggle"
                data-toggle="dropdown"
                href="/game-overview"
                
                role="button">
                Game
              </a>

              <ul class="custom-dropdown-menu" role="menu">
                
                  <li role="presentation">
                    <a href=/starter-page>
                      Starter Page
                    </a>
                  </li>
                
                  <li role="presentation">
                    <a href=/screenshots>
                      Screenshots
                    </a>
                  </li>
                
                  <li role="presentation">
                    <a href=/videos>
                      Videos
                    </a>
                  </li>
                
                  <li role="presentation">
                    <a href=/content>
                      Content
                    </a>
                  </li>
                
                  <li role="presentation">
                    <a href=/modding>
                      Modding
                    </a>
                  </li>
                
                  <li role="presentation">
                    <a href=/team>
                      Team
                    </a>
                  </li>
                
              </ul>

            

            </li>
        
          
            <li  class="custom-dropdown" >

            

              <a class="custom-dropdown-toggle"
                data-toggle="dropdown"
                href="/support-overview"
                
                role="button">
                Support
              </a>

              <ul class="custom-dropdown-menu" role="menu">
                
                  <li role="presentation">
                    <a href=/help>
                      Help
                    </a>
                  </li>
                
                  <li role="presentation">
                    <a href=/faq>
                      FAQ
                    </a>
                  </li>
                
                  <li role="presentation">
                    <a href=/press-and-youtube>
                      Press and Youtube
                    </a>
                  </li>
                
                  <li role="presentation">
                    <a href=/community>
                      Community
                    </a>
                  </li>
                
                  <li role="presentation">
                    <a href=/partners>
                      Partners
                    </a>
                  </li>
                
                  <li role="presentation">
                    <a href=/credits>
                      Credits
                    </a>
                  </li>
                
              </ul>

            

            </li>
        
          
            <li >

            
              <a href=https://forums.factorio.com/
                 
              > Forums </a>
            

            </li>
        
          
            <li >

            
              <a href=/contact
                 
              > Contact </a>
            

            </li>
        

      </ul>
     </div>
     </div>
    </div>
   </div>
  <div class="container">
    <noscript>
      <div class="alert alert-block alert-error" style="font-weight: bold; ">
        Javascript is required for proper functioning of these web pages.
      </div>
    </noscript>

    
        
    

    
        
    

    

    

<div class="row">
  <div class="span12 blog-post">
    <h2 style="margin-top: 20px; margin-bottom:5px;">
      Friday Facts #60 - Tests all around
    </h2>

    <div style="font-size: 11px;">Posted by Tomas on 2014-11-14, <a href="/blog/">all posts</a></div>

    <p>
    <p>Hey guys,</p>

<p>
  here comes the weekly dose of Factorio-world information for you. We have crafted it just before we leave for a <a href="http://gdsession.com/">gdsession</a> warm-up party. Gdsession is quite a big game development conference here in Prague. This is the first year we are going to participate. And actually tonight we will have a short (10 minut) talk about what we do (well, about Factorio obviously).
</p>

<h4> Release on Thursday </h4>
<p>
Long long time ago, we used to have releases on Thursday. It is actually so long ago, that only the most hard-core fans will remember that. We have abandoned this for a simple reason. There was a Thursday and we were still coding like crazy. So we postponed the release to Friday back then. Now we would like to get back to "release on Thursday" scheme. The reasons are clear:
<ul>
<li> There is much less stress on Thursday than on Friday (when fans are ready for the weekend and "demanding" the release:)). </li>
<li> We are people. Friday is the day to spend evenings with friends (and not fixing last minute bugs to ship the release :)). </li>
<li> If something goes wrong we can make a hotfix the next day and still ship the release for the weekend. </li>
</ul>

So yesterday we started a new tradition of releasing on Thursday instead of on Friday (of course it doesn't mean every Thursday). This was done by coming out with the <a href="https://forums.factorio.com/forum/viewtopic.php?f=3&t=6661">0.11.2</a>. Full of bug fixes, couple of cosmetic multiplayer improvements (last IP address of server is remembered) and sweet new graphics for the logistic bots. The third point in the above list has already shown to be valid because today we have made a <a href="https://forums.factorio.com/forum/viewtopic.php?f=3&t=6683">0.11.3</a> hotfix which should fix a few annoying and game preventing bugs (looking at you "manual train building crash").
</p>

<h4> Automated testing </h4>
<p>
Almost a year ago we <a href="https://forums.factorio.com/forum/viewtopic.php?f=38&t=1911">first mentioned</a> that we would start with automated testing. Since then the topic of automated testing came up <a href="https://www.factorio.com//blog/post/fff-29">couple</a> of <a href="https://www.factorio.com//blog/post/fff-53">times</a>. For a long time our testing suite was just ridiculous (meaning not doing much). But that has changed recently. We have spent quite some time writing tests in the past weeks and working on our testing framework. And that effoert is starting to pay off. We are slowly getting into (very much beneficial) mindset of writing tests for any new functionality we add to the game. We believe, this is something that will pay off in the long run (especially taking into account the complexity of the game - and the code behind - that is there already). At the moment we have two growing sets of tests.
</p>

<p>
<strong>Unit tests</strong> are aimed at testing non-trivial internal functions. They work with mocked objects and the result is that they give us a certain assurance that the specific part of the code functions correctly on itself. They are really fast to run, this is because they don't load any graphics nor any prototypes (data from the base mod). Examples of unit tests are testing synchronization mechanisms in the multiplayer code, tests in the crafting queue logic or even testing that floating point operations give the same result on all our architectures.
</p>

<p>
<strong>Integration tests</strong> on the other hand test the game as a whole (with data present in the base mod). The standard pattern here is that every test creates a small map, places couple of objects on the map, runs updates and then verifies that expected conditions are met. For instance the test can create a tricky belt setup, place some items at the belts and then check whether after some updates, the items are blocked on belts as expected. Integration tests are really helpful for determinism regression testing. After every test (and sometimes in the process of it as well) a crc check is made against the set of presaved crc values (these are simply regenerated when the game logic changes).. This means that if a bug is introduced that would break determinism (giving different results under different circumstances or on different operating systems) in code covered by tests, we will find out just by running the test suite. And that is something we plan to do automatically when building the game (the build server configuration is in progress:)).
</p>

<p>
One more test suite is slowly shaping up in our minds. This one doesn't have the name yet, but it is aimed at testing the game completely from outside (could be called "<strong>black box</strong>" testing - because Factorio binary is treated as a black box from the outside). This is necessary to test some multiplayer edge cases and useful for testing gui interaction. For instance in the 0.11.x there is a known issue of game desync / crash when multiple players connect to the game at the same time. The "black box" test here would simply start three instances of the game and then via a control script coordinate the instances to join the multiplayer game at the some time. Not only would this be a reproducible way of testing such a case, but it would be actually useful in figuring out what the problem is. At the moment if I run three instances of the game at my computer the system gets really laggy and it is hard to do any debugging (that is why the mentioned bug is not yet fixed). As a bonus the mechanism for "black box" testing could be used for running "headless" (no graphics) servers for multiplayer (a feature quite a few people on the forums asked for).
</p>

<p>
So in short we are going in the automated testing direction now. And we are actually having fun doing so. That doesn't mean that there will be no bugs from now on:) But it should help us avoid same bugs in the future and give us more confidence for refactorings.
</p>

<h4> Player running animation </h4>
<p>
The 0.11 has brought a new player model. In general we are really happy with it, however the running animation has been a big PITA from the beginning. We have failed to get it just right. And the players noticed. The thing is that it is not that simple. Albert has done many tests, studied the movement of human bodies and watched videos of professional runners to come out with good looking animation. If you came to see us in our office sometimes this week there is a good chance we would be running around in the "graphics department room" trying to analyze the natural human movement while running:) Anyway we are getting closer to a working version, so this will be fixed during the 0.11.x stabilization process. In the meantime you can have a look at the history of the running animation shown in gifs below.
</p>

<p style="margin:auto; margin-top:20px; ">
   <img src="https://cdn.factorio.com/assets/img/blog/fff-60-player-walk-00.gif"/>
   <img src="https://cdn.factorio.com/assets/img/blog/fff-60-player-walk-01.gif"/>
   <img src="https://cdn.factorio.com/assets/img/blog/fff-60-player-walk-02.gif"/>
   <img src="https://cdn.factorio.com/assets/img/blog/fff-60-player-walk-03.gif"/>
   <img src="https://cdn.factorio.com/assets/img/blog/fff-60-player-walk-04.gif"/>
   <img src="https://cdn.factorio.com/assets/img/blog/fff-60-player-walk-05.gif"/>
   <img src="https://cdn.factorio.com/assets/img/blog/fff-60-player-walk-06.gif"/>
   <img src="https://cdn.factorio.com/assets/img/blog/fff-60-player-walk-07.gif"/>
</p>

<p style="margin:auto; margin-top:3px; margin-bottom: 40px; ">
   <img src="https://cdn.factorio.com/assets/img/blog/fff-60-player-walk-08.gif"/>
   <img src="https://cdn.factorio.com/assets/img/blog/fff-60-player-walk-09.gif"/>
   <img src="https://cdn.factorio.com/assets/img/blog/fff-60-player-walk-10.gif"/>
   <img src="https://cdn.factorio.com/assets/img/blog/fff-60-player-walk-11.gif"/>
   <img src="https://cdn.factorio.com/assets/img/blog/fff-60-player-walk-12.gif"/>
   <img src="https://cdn.factorio.com/assets/img/blog/fff-60-player-walk-13.gif"/>
   <img src="https://cdn.factorio.com/assets/img/blog/fff-60-player-walk-14.gif"/>
   <img src="https://cdn.factorio.com/assets/img/blog/fff-60-player-walk-15.gif"/>
</p>

<p>
If you have anything to say, <a href="https://forums.factorio.com/forum/viewtopic.php?f=38&t=6682">the thread</a> at the forum is there for you.
</p>
 
    </p>



    <div class="footer">

      <div class="footer-copyright">
          Copyright © 2015 - 2018 Wube Software - all rights reserved.
        </div>
        <div class="footer-menu">

          

          <a href="/terms-of-service" style="font-size: 11px;"> Terms of Service </a>
          <span style="font-size: 11px;"> | </span>
          

          <a href="/privacy-policy" style="font-size: 11px;"> Privacy </a>
          <span style="font-size: 11px;"> | </span>
          

          <a href="/imprint" style="font-size: 11px;"> Imprint </a>
          <span style="font-size: 11px;"> | </span>
          

          <a href="/presskit" style="font-size: 11px;"> Presskit </a>
          <span style="font-size: 11px;"> | </span>
          

          <a href="/faq" style="font-size: 11px;"> FAQ </a>
          <span style="font-size: 11px;"> | </span>
          

          <a href="/blog/rss" style="font-size: 11px;"> RSS </a>
          <span style="font-size: 11px;"> | </span>
          

          <a href="/jobs" style="font-size: 11px;">
            Jobs
          </a>
      </div>
    </div>
  </div>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
  
  <script src="/static/js/raphael-min.js" type="text/javascript"></script>
  <script src="/static/js/factorio.min.js" type="text/javascript"></script>
  <script src="/static/lightbox/js/lightbox.min.js" type="text/javascript"></script>
  <script type="text/javascript">
   var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-115167276-1']);
        _gaq.push(['_trackPageview']);
        (function()
        {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
  </script>
 </body>
</html>